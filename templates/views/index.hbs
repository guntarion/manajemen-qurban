<table id="statusSapi">
    <thead>
        <tr>
            {{#each (range 1 10) as |i|}}
            <th>🐮{{i}}</th>
            {{/each}}
        </tr>
    </thead>
    <tbody>
        <tr>
            {{#each (range 1 10) as |i|}}
            <td id="S{{i}}">⬜️</td>
            {{/each}}
        </tr>
        <tr>
            {{#each (range 11 20) as |i|}}
            <td id="S{{i}}">⬜️</td>
            {{/each}}
        </tr>
    </tbody>
</table>


<table id="statusKambing">
    <thead>
        <tr>
            {{#each (range 1 15) as |i|}}
            <th>🐐{{i}}</th>
            {{/each}}
        </tr>
    </thead>
    <tbody>
        <tr>
            {{#each (range 1 15) as |i|}}
            <td id="K{{i}}">⬜️</td>
            {{/each}}
        </tr>
        <tr>
            {{#each (range 16 30) as |i|}}
            <td id="K{{i}}">⬜️</td>
            {{/each}}
        </tr>
        <tr>
            {{#each (range 31 45) as |i|}}
            <td id="K{{i}}">⬜️</td>
            {{/each}}
        </tr>
    </tbody>
</table>


<h3>Komulatif Timbang</h3>
<table id="numberTimbangFromDatabase">
    <tr>
        <th style="width: 100px; font-size: 25px; text-align: center;">🐮 3</th>
        <th style="width: 100px; font-size: 25px; text-align: center;">🐮 1</th>
        <th style="width: 100px; font-size: 25px; text-align: center;">🐮 ½</th>
        <th style="width: 100px; font-size: 25px; text-align: center;">🐐 ½</th>
        <th style="width: 100px; font-size: 25px; text-align: center;">🐣 ½</th>
        <th style="width: 100px; font-size: 25px; text-align: center;">🪺</th>
    </tr>
    <tr>
        <td id="sapi3kg-database" style="font-size: 40px; text-align: center;">{{timbang.Sapi_three_kg.hasil}}</td>
        <td id="sapi1kg-database" style="font-size: 40px; text-align: center;">{{timbang.Sapi_one_kg.hasil}}</td>
        <td id="sapiHalfKg-database" style="font-size: 40px; text-align: center;">{{timbang.Sapi_half_kg.hasil}}</td>
        <td id="kambingHalfKg-database" style="font-size: 40px; text-align: center;">{{timbang.Kambing_half_kg.hasil}}</td>
        <td id="campurHalfKg-database" style="font-size: 40px; text-align: center;">{{timbang.Campur_half_kg.hasil}}</td>
        <td id="jeroan-database" style="font-size: 40px; text-align: center;">{{timbang.Jeroan.hasil}}</td>
    </tr>
</table>



<h3>Komulatif Inventory</h3>
<table id="numberInventoryFromDatabase">
    <tr>
        <th style="width: 400px; font-size: 25px; text-align: center;">Jenis</th>
        <th style="width: 140px; font-size: 25px; text-align: center;">Kuanti</th>
        <th style="width: 140px; font-size: 25px; text-align: center;">Target</th>
        <th style="width: 140px; font-size: 25px; text-align: center;">Prosen</th>
        <th style="width: 140px; font-size: 25px; text-align: center;">Kurang</th>
    </tr>
    <tr>
        <td style="font-size: 23px; text-align: center; padding: 20px">🐮🙂 3 kg (Pengqurban)</td>
        <td id="sapipengqurban3kg-value" style="font-size: 27px; text-align: center; padding: 20px">
            {{inventory.sapipengqurban3kg.hasil}}</td>
        <td id="sapipengqurban3kg-target" style="font-size: 27px; text-align: center; padding: 20px">
            {{inventory.sapipengqurban3kg.target_value}}</td>
        <td id="sapipengqurban3kg-percent" style="font-size: 27px; text-align: center; padding: 20px">0%</td>
        <td id="sapipengqurban3kg-remaining" style="font-size: 27px; text-align: center; padding: 20px">
            {{inventory.sapipengqurban3kg.target_value}}</td>
    </tr>
    <tr>
        <td style="font-size: 23px; text-align: center; padding: 20px">🐮🐐 2 kg (Panitia)</td>
        <td id="sapikambing2kg-value" style="font-size: 27px; text-align: center; padding: 20px">
            {{inventory.sapikambing2kg.hasil}}</td>
        <td id="sapikambing2kg-target" style="font-size: 27px; text-align: center; padding: 20px">
            {{inventory.sapikambing2kg.target_value}}</td>
        <td id="sapikambing2kg-percent" style="font-size: 27px; text-align: center; padding: 20px">0%</td>
        <td id="sapikambing2kg-remaining" style="font-size: 27px; text-align: center; padding: 20px">
            {{inventory.sapikambing2kg.target_value}}</td>
    </tr>
    <tr>
        <td style="font-size: 23px; text-align: center; padding: 20px">🐮🐣 1 kg (Umum #1)</td>
        <td id="sapicampur1kg-value" style="font-size: 27px; text-align: center; padding: 20px">
            {{inventory.sapicampur1kg.hasil}}</td>
        <td id="sapicampur1kg-target" style="font-size: 27px; text-align: center; padding: 20px">
            {{inventory.sapicampur1kg.target_value}}</td>
        <td id="sapicampur1kg-percent" style="font-size: 27px; text-align: center; padding: 20px">0%</td>
        <td id="sapicampur1kg-remaining" style="font-size: 27px; text-align: center; padding: 20px">
            {{inventory.sapicampur1kg.target_value}}</td>
    </tr>
    <tr>
        <td style="font-size: 23px; text-align: center; padding: 20px">🐐🐣 1 kg (Umum #2)</td>
        <td id="kambingcampur1kg-value" style="font-size: 27px; text-align: center; padding: 20px">
            {{inventory.kambingcampur1kg.hasil}}</td>
        <td id="kambingcampur1kg-target" style="font-size: 27px; text-align: center; padding: 20px">
            {{inventory.kambingcampur1kg.target_value}}</td>
        <td id="kambingcampur1kg-percent" style="font-size: 27px; text-align: center; padding: 20px">0%</td>
        <td id="kambingcampur1kg-remaining" style="font-size: 27px; text-align: center; padding: 20px">
            {{inventory.kambingcampur1kg.target_value}}</td>
    </tr>
</table>


<h3>Distribusi</h3>

<table>
    <tr>
        <th style="width: 200px; font-size: 21px; text-align: center;">Kategori</th>
        <th style="width: 100px; font-size: 21px; text-align: center;">Target</th>
        <th style="width: 100px; font-size: 21px; text-align: center;">Terealisasi</th>
        <th style="width: 100px; font-size: 21px; text-align: center;">Progress</th>
    </tr>
    <tr>
        <td style="font-size: 21px; text-align: center; padding: 20px">Pengqurban Sapi</td>
        <td style="font-size: 21px; text-align: center; padding: 20px">0</td>
        <td style="font-size: 21px; text-align: center; padding: 20px">0</td>
        <td style="font-size: 21px; text-align: center; padding: 20px">0%</td>
    </tr>
    <tr>
        <td style="font-size: 21px; text-align: center; padding: 20px">Pengqurban Kambing</td>
        <td style="font-size: 21px; text-align: center; padding: 20px">0</td>
        <td style="font-size: 21px; text-align: center; padding: 20px">0</td>
        <td style="font-size: 21px; text-align: center; padding: 20px">0%</td>
    </tr>
    <tr>
        <td style="font-size: 21px; text-align: center; padding: 20px">Panitia</td>
        <td style="font-size: 21px; text-align: center; padding: 20px">0</td>
        <td style="font-size: 21px; text-align: center; padding: 20px">0</td>
        <td style="font-size: 21px; text-align: center; padding: 20px">0%</td>
    </tr>
    <tr>
        <td style="font-size: 21px; text-align: center; padding: 20px">RT RW</td>
        <td style="font-size: 21px; text-align: center; padding: 20px">0</td>
        <td style="font-size: 21px; text-align: center; padding: 20px">0</td>
        <td style="font-size: 21px; text-align: center; padding: 20px">0%</td>
    </tr>
    <tr>
        <td style="font-size: 21px; text-align: center; padding: 20px">Lembaga</td>
        <td style="font-size: 21px; text-align: center; padding: 20px">0</td>
        <td style="font-size: 21px; text-align: center; padding: 20px">0</td>
        <td style="font-size: 21px; text-align: center; padding: 20px">0%</td>
    </tr>
</table>




<style>

    #statusSapi th, #statusSapi td, #statusKambing th, #statusKambing td {
        width: 90px;
        font-size: 25px;
        text-align: center;
    }

    table {
        border-collapse: collapse;
    }

    td,
    th {
        border-right: 1px solid #000;
        border-left: 1px solid #000;
    }

    th:first-child,
    td:first-child {
        border-left: none;
    }

    th:last-child,
    td:last-child {
        border-right: none;
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', (event) => {
        const serverAddress = "{{wsUrl}}";
        const socket = new WebSocket(serverAddress);

        socket.addEventListener('open', (event) => {
            console.log('Index Page is Connected to WebSocket server');
        });

        socket.addEventListener('message', (event) => {
            const data = JSON.parse(event.data);
            console.log('WebSocket message received:', data);

            if (data.type === 'update-inventory') {
                updateInventory('sapipengqurban3kg', data.inventory.sapipengqurban3kg.hasil, data.inventory.sapipengqurban3kg.target_value);
                updateInventory('sapikambing2kg', data.inventory.sapikambing2kg.hasil, data.inventory.sapikambing2kg.target_value);
                updateInventory('sapicampur1kg', data.inventory.sapicampur1kg.hasil, data.inventory.sapicampur1kg.target_value);
                updateInventory('kambingcampur1kg', data.inventory.kambingcampur1kg.hasil, data.inventory.kambingcampur1kg.target_value);
            } else if (data.type === 'update-timbang') {
                document.getElementById('sapi3kg-database').textContent = data.timbang.Sapi_three_kg.hasil;
                document.getElementById('sapi1kg-database').textContent = data.timbang.Sapi_one_kg.hasil;
                document.getElementById('sapiHalfKg-database').textContent = data.timbang.Sapi_half_kg.hasil;
                document.getElementById('kambingHalfKg-database').textContent = data.timbang.Kambing_half_kg.hasil;
                document.getElementById('campurHalfKg-database').textContent = data.timbang.Campur_half_kg.hasil;
                document.getElementById('jeroan-database').textContent = data.timbang.Jeroan.hasil;
            }
        });

        socket.addEventListener('close', (event) => {
            console.log('Index Page is Disconnected from WebSocket server');
        });

        function updateInventory(id, value, target) {
            const valueElement = document.getElementById(`${id}-value`);
            const percentElement = document.getElementById(`${id}-percent`);
            const remainingElement = document.getElementById(`${id}-remaining`);
            const targetElement = document.getElementById(`${id}-target`);

            valueElement.textContent = value;
            targetElement.textContent = target;
            const percentage = ((value / target) * 100).toFixed(2);
            percentElement.textContent = `${percentage}%`;
            remainingElement.textContent = target - value;
        }
    });
</script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const socket = new WebSocket("{{wsUrl}}");

        socket.addEventListener('open', () => {
            console.log("Connected to WebSocket server");
        });

        socket.addEventListener('close', () => {
            console.log("Disconnected from WebSocket server");
        });

        socket.addEventListener('message', (event) => {
            const data = JSON.parse(event.data);
            if (data.type === "update-sembelih") {
                const cell = document.getElementById('S' + data.id);
                cell.textContent = data.sembelih ? '✅' : '⬜️';
            } else if (data.type === "update-sembelih-kambing") {
                const cell = document.getElementById('K' + data.id);
                cell.textContent = data.sembelih ? '✅' : '⬜️';
            }
        });
    });
</script>